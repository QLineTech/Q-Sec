```python
from langchain.chains import LLMChain
from langchain_groq import ChatGroq
from langchain.prompts import PromptTemplate
import requests
import socket
import json
from datetime import datetime
import hashlib
import re

class SecurityResearchFramework:
    """
    GÃ¼venlik araÅŸtÄ±rmasÄ± ve eÄŸitimi iÃ§in tasarlanmÄ±ÅŸ framework.
    Bu framework, yaygÄ±n gÃ¼venlik test senaryolarÄ±nÄ± simÃ¼le eder.
    !!! YalnÄ±zca eÄŸitim ve araÅŸtÄ±rma amaÃ§lÄ± kullanÄ±lmalÄ±dÄ±r !!!
    """
    
    def __init__(self, api_key):
        self.llm = ChatGroq(api_key=api_key, temperature=0.7)
        self.setup_chains()
        self.findings = []
        
    def setup_chains(self):
        """LangChain zincirlerini yapÄ±landÄ±r"""
        # GÃ¼venlik analiz ÅŸablonu
        analysis_template = """
        Bu gÃ¼venlik test senaryosunu analiz et:
        {scenario}
        
        Test hedefi: {target}
        Bulunan gÃ¶stergeler: {indicators}
        
        LÃ¼tfen ÅŸunlarÄ± belirt:
        1. Risk seviyesi ve olasÄ± etkiler
        2. Tespit yÃ¶ntemleri ve gÃ¶stergeler
        3. Savunma stratejileri ve Ã¶nlemler
        4. Ä°yileÅŸtirme Ã¶nerileri
        """
        
        self.analysis_chain = LLMChain(
            llm=self.llm,
            prompt=PromptTemplate(
                input_variables=["scenario", "target", "indicators"],
                template=analysis_template
            ),
            verbose=True
        )
        
    def simulate_security_check(self, target):
        """
        GÃ¼venlik kontrolÃ¼ simÃ¼lasyonu yapar.
        Bu fonksiyon, yaygÄ±n gÃ¼venlik kontrollerini simÃ¼le eder.
        """
        findings = {
            "headers": self._check_headers(target),
            "ports": self._check_common_ports(target),
            "response_analysis": self._analyze_responses(target)
        }
        
        return findings
        
    def _check_headers(self, target):
        """HTTP baÅŸlÄ±klarÄ±nÄ± kontrol eder"""
        try:
            response = requests.head(f"http://{target}")
            headers = dict(response.headers)
            
            security_headers = {
                'Strict-Transport-Security': False,
                'X-Content-Type-Options': False,
                'X-Frame-Options': False,
                'X-XSS-Protection': False,
                'Content-Security-Policy': False
            }
            
            # GÃ¼venlik baÅŸlÄ±klarÄ±nÄ± kontrol et
            for header in security_headers.keys():
                if header in headers:
                    security_headers[header] = True
                    
            return security_headers
            
        except Exception as e:
            return {"error": str(e)}
    
    def _check_common_ports(self, target):
        """YaygÄ±n portlarÄ± kontrol eder"""
        common_ports = [21, 22, 23, 25, 80, 443, 445, 3306, 3389, 8080]
        open_ports = []
        
        for port in common_ports:
            sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            sock.settimeout(1)
            result = sock.connect_ex((target, port))
            if result == 0:
                open_ports.append(port)
            sock.close()
            
        return open_ports
    
    def _analyze_responses(self, target):
        """HTTP yanÄ±tlarÄ±nÄ± analiz eder"""
        paths = ['/', '/admin', '/login', '/wp-admin', '/phpinfo.php']
        responses = {}
        
        for path in paths:
            try:
                url = f"http://{target}{path}"
                response = requests.get(url, timeout=3)
                responses[path] = {
                    'status_code': response.status_code,
                    'length': len(response.content),
                    'server': response.headers.get('Server', 'Unknown')
                }
            except Exception as e:
                responses[path] = {'error': str(e)}
                
        return responses
    
    def analyze_target(self, target):
        """
        Hedefi analiz eder ve gÃ¼venlik deÄŸerlendirmesi yapar.
        """
        # GÃ¼venlik kontrollerini gerÃ§ekleÅŸtir
        findings = self.simulate_security_check(target)
        
        # GÃ¶stergeleri hazÄ±rla
        indicators = self._prepare_indicators(findings)
        
        # Senaryo oluÅŸtur
        scenario = f"""
        Hedef sistem Ã¼zerinde gÃ¼venlik kontrolÃ¼ gerÃ§ekleÅŸtirildi.
        AÃ§Ä±k portlar: {findings['ports']}
        Eksik gÃ¼venlik baÅŸlÄ±klarÄ±: {[h for h, v in findings['headers'].items() if not v]}
        ÅÃ¼pheli endpoint'ler: {[p for p, r in findings['response_analysis'].items() 
                              if isinstance(r, dict) and r.get('status_code') in [200, 301, 302]]}
        """
        
        # LLM analizi yap
        analysis = self.analysis_chain.run(
            scenario=scenario,
            target=target,
            indicators=indicators
        )
        
        # SonuÃ§larÄ± yapÄ±landÄ±r
        return {
            "timestamp": datetime.now().isoformat(),
            "target": target,
            "findings": findings,
            "analysis": self._parse_analysis(analysis),
            "risk_score": self._calculate_risk_score(findings)
        }
    
    def _prepare_indicators(self, findings):
        """BulgularÄ± analiz iÃ§in hazÄ±rlar"""
        indicators = []
        
        # Port gÃ¶stergeleri
        if findings['ports']:
            indicators.append(f"AÃ§Ä±k portlar tespit edildi: {findings['ports']}")
            
        # BaÅŸlÄ±k gÃ¶stergeleri
        missing_headers = [h for h, v in findings['headers'].items() if not v]
        if missing_headers:
            indicators.append(f"Eksik gÃ¼venlik baÅŸlÄ±klarÄ±: {missing_headers}")
            
        # YanÄ±t gÃ¶stergeleri
        for path, response in findings['response_analysis'].items():
            if isinstance(response, dict) and 'status_code' in response:
                if response['status_code'] in [200, 301, 302]:
                    indicators.append(f"EriÅŸilebilir endpoint: {path}")
                    
        return indicators
    
    def _parse_analysis(self, raw_analysis):
        """LLM analizini yapÄ±landÄ±rÄ±lmÄ±ÅŸ formata dÃ¶nÃ¼ÅŸtÃ¼rÃ¼r"""
        sections = {
            "risk_assessment": [],
            "detection_methods": [],
            "defense_strategies": [],
            "remediation": []
        }
        
        current_section = None
        for line in raw_analysis.split('\n'):
            line = line.strip()
            if '1. Risk seviyesi' in line:
                current_section = "risk_assessment"
            elif '2. Tespit yÃ¶ntemleri' in line:
                current_section = "detection_methods"
            elif '3. Savunma stratejileri' in line:
                current_section = "defense_strategies"
            elif '4. Ä°yileÅŸtirme Ã¶nerileri' in line:
                current_section = "remediation"
            elif line and current_section:
                sections[current_section].append(line)
                
        return sections
    
    def _calculate_risk_score(self, findings):
        """Bulgulara gÃ¶re risk skoru hesaplar"""
        score = 0
        
        # Port bazlÄ± risk
        dangerous_ports = {21: 3, 23: 4, 445: 4, 3389: 4}
        for port in findings['ports']:
            score += dangerous_ports.get(port, 1)
            
        # BaÅŸlÄ±k bazlÄ± risk
        for header, present in findings['headers'].items():
            if not present:
                score += 2
                
        # YanÄ±t bazlÄ± risk
        for path, response in findings['response_analysis'].items():
            if isinstance(response, dict) and 'status_code' in response:
                if response['status_code'] == 200 and path in ['/admin', '/wp-admin']:
                    score += 3
                    
        return min(10, score)  # Maksimum 10 Ã¼zerinden puanla

def main():
    try:
        # Framework'Ã¼ baÅŸlat
        framework = SecurityResearchFramework("your-api-key")
        
        # Test hedefi (Ã¶rnek olarak kullanÄ±n)
        target = "example.com"
        
        print(f"\nğŸ” {target} iÃ§in gÃ¼venlik analizi baÅŸlatÄ±lÄ±yor...")
        results = framework.analyze_target(target)
        
        # SonuÃ§larÄ± gÃ¶ster
        print("\nğŸ“Š Analiz SonuÃ§larÄ±")
        print("=" * 50)
        
        print(f"\nğŸ¯ Hedef: {results['target']}")
        print(f"âš ï¸ Risk Skoru: {results['risk_score']}/10")
        
        print("\nğŸ”“ AÃ§Ä±k Portlar:")
        for port in results['findings']['ports']:
            print(f"- Port {port}")
            
        print("\nğŸ›¡ï¸ GÃ¼venlik BaÅŸlÄ±klarÄ±:")
        for header, present in results['findings']['headers'].items():
            status = "âœ…" if present else "âŒ"
            print(f"{status} {header}")
            
        print("\nğŸ“ LLM Analizi:")
        analysis = results['analysis']
        
        print("\nRisk DeÄŸerlendirmesi:")
        for risk in analysis['risk_assessment']:
            print(f"- {risk}")
            
        print("\nSavunma Stratejileri:")
        for strategy in analysis['defense_strategies']:
            print(f"- {strategy}")
            
        print("\nÄ°yileÅŸtirme Ã–nerileri:")
        for recommendation in analysis['remediation']:
            print(f"- {recommendation}")
        
    except Exception as e:
        print(f"Hata oluÅŸtu: {str(e)}")

if __name__ == "__main__":
    main()
```



Bu framework, gÃ¼venlik araÅŸtÄ±rmacÄ±larÄ± iÃ§in Ã¶nemli Ã¶zelliklere sahip:

1. **GÃ¼venlik KontrolÃ¼ SimÃ¼lasyonu:**
   - HTTP baÅŸlÄ±k analizi yapÄ±yor
   - YaygÄ±n portlarÄ± kontrol ediyor
   - HTTP yanÄ±tlarÄ±nÄ± analiz ediyor
   - Risk skorlamasÄ± gerÃ§ekleÅŸtiriyor

2. **AkÄ±llÄ± Analiz Sistemi:**
   - LLM ile detaylÄ± gÃ¼venlik analizi
   - Risk deÄŸerlendirmesi
   - Savunma stratejileri Ã¶nerileri
   - Ä°yileÅŸtirme tavsiyeleri

3. **GÃ¼venlik GÃ¶stergeleri:**
   - Eksik gÃ¼venlik baÅŸlÄ±klarÄ±
   - AÃ§Ä±k portlar
   - ÅÃ¼pheli endpoint'ler
   - YanÄ±t analizi

Ã–rnek kullanÄ±m:
```python
# Framework'Ã¼ baÅŸlat
framework = SecurityResearchFramework("your-api-key")

# Hedefi analiz et
results = framework.analyze_target("example.com")

# Risk skorunu gÃ¶r
print(f"Risk Skoru: {results['risk_score']}/10")

# GÃ¼venlik Ã¶nerilerini al
print(results['analysis']['defense_strategies'])
```



Bu framework'i gÃ¼venlik eÄŸitimlerinde ve test ortamlarÄ±nda kullanabilirsiniz. UnutmayÄ±n, bu araÃ§ yalnÄ±zca eÄŸitim ve araÅŸtÄ±rma amaÃ§lÄ±dÄ±r. 

